import requests
import pandas as pd

def load_tickers_from_wikipedia(index_name):
    url = 'https://en.wikipedia.org/wiki/List_of_S%26P_500_companies'
    response = requests.get(url)
    tables = pd.read_html(response.text)
    
    tickers = []
    for table in tables:
        if 'Symbol' in table.columns:
            if index_name == 'S&P 500':
                tickers += table['Symbol'].tolist()
            elif index_name == 'S&P 400' and 'Index' in table.columns:
                filtered = table[table['Index'] == 'S&P MidCap 400']
                tickers += filtered['Symbol'].tolist()
            elif index_name == 'S&P 600' and 'Index' in table.columns:
                filtered = table[table['Index'] == 'S&P SmallCap 600']
                tickers += filtered['Symbol'].tolist()
    
    # Remove duplicates and format tickers
    tickers = list(set(tickers))
    tickers = [ticker.upper().replace('.', '-') for ticker in tickers]
    return tickers

if __name__ == "__main__":
    index_name = 'S&P 500'  # example index
    tickers = load_tickers_from_wikipedia(index_name)
    with open('universe.txt', 'w') as f:
        for ticker in tickers:
            f.write(ticker + '\n')